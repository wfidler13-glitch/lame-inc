<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GVZQ50F49X"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-GVZQ50F49X');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DO NOT WAIT</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@700;900&display=swap');
        
        body {
            /* Unified Theme: White BG, Black Text */
            font-family: 'Barlow Condensed', sans-serif;
            background-color: #ffffff; 
            color: #000000; 
            overflow: hidden; 
            user-select: none;
            touch-action: manipulation; 
        }
    </style>
</head>
<body>

    <div id="app" class="min-h-screen flex flex-col items-center justify-center p-4 cursor-pointer">
        
        <!-- Main Container for Game Elements -->
        <div id="game-container" class="text-center">
            
            <!-- Main Instruction Text -->
            <h1 id="main-text" class="text-8xl sm:text-9xl font-black mb-12 tracking-tighter uppercase select-none text-black leading-none">
                DO NOT WAIT
            </h1>
            
            <!-- The Countdown Timer - Black -->
            <div id="timer-display" class="text-9xl font-black text-black select-none">
                404
            </div>
        </div>

        <!-- Failure Message Container -->
        <div id="message-area" class="hidden">
            <h2 class="text-7xl sm:text-9xl font-black text-black">THANK YOU.</h2>
        </div>

    </div>

    <script>
        // --- Configuration ---
        const SUCCESS_URL = "https://forms.gle/giq887BJnStoBQbj8"; 
        const INITIAL_COUNTDOWN_TIME = 404; // Phase 1 Duration
        const INVISIBLE_LIMIT_TIME = 11;    // Phase 2 Total Duration (Updated to 11s)
        const TARGET_TAPS = 11;             // Exact number of taps required
        const SILENCE_THRESHOLD = 3000;     // Time to wait after last tap (Updated to 3s)

        // --- State ---
        let currentPhase = 'initial'; 
        let initialTimeLeft = INITIAL_COUNTDOWN_TIME;
        let invisibleTimeLeft = INVISIBLE_LIMIT_TIME;
        
        let timerInterval;       
        let silenceTimeout;      
        let tapCount = 0;        

        // --- Elements ---
        const app = document.getElementById('app');
        const gameContainer = document.getElementById('game-container');
        const messageArea = document.getElementById('message-area');
        const timerDisplay = document.getElementById('timer-display');
        const mainText = document.getElementById('main-text');

        // --- Core Functions ---

        function closeWindow() {
            try {
                window.open('', '_self', ''); 
                window.close();
            } catch (e) {
                console.log("Close blocked.");
            }
            setTimeout(() => {
                window.location.href = "about:blank";
            }, 100);
        }

        function failGame() {
            if (currentPhase === 'ended') return;
            currentPhase = 'ended';
            
            clearInterval(timerInterval);
            clearTimeout(silenceTimeout);

            gameContainer.classList.add('hidden');
            messageArea.classList.remove('hidden');

            setTimeout(() => {
                closeWindow();
            }, 2000);
        }

        function winGame() {
            if (currentPhase === 'ended') return;
            currentPhase = 'ended';
            
            clearInterval(timerInterval);
            clearTimeout(silenceTimeout);
            
            window.location.href = SUCCESS_URL;
        }

        // --- Phase 2 Logic (Tapping) ---

        function startInvisibleTimer() {
            currentPhase = 'action';
            
            // Update UI
            timerDisplay.classList.add('hidden');
            mainText.innerHTML = "DO NOT TAP / CLICK<br>EXACTLY 11 TIMES";
            
            // Ensure visual consistency (Black text, pulsing)
            mainText.classList.remove('text-black');
            mainText.classList.add('text-black', 'animate-pulse');

            // Start global timeout for Phase 2
            timerInterval = setInterval(() => {
                invisibleTimeLeft--;
                console.log("Time Left:", invisibleTimeLeft);
                
                if (invisibleTimeLeft <= 0) {
                    failGame();
                }
            }, 1000);
        }

        function handleTap() {
            if (currentPhase !== 'action') return;

            tapCount++;
            console.log("Tap count:", tapCount);
            
            // Reset waiting timer on every tap
            if (silenceTimeout) clearTimeout(silenceTimeout);

            // Wait 3 seconds to confirm they have stopped tapping
            silenceTimeout = setTimeout(() => {
                if (tapCount === TARGET_TAPS) {
                    winGame();
                } else {
                    failGame();
                }
            }, SILENCE_THRESHOLD);
        }

        // --- Phase 1 Logic (Waiting) ---

        function startInitialTimer() {
            timerDisplay.textContent = initialTimeLeft;
            
            timerInterval = setInterval(() => {
                initialTimeLeft--;
                
                if (initialTimeLeft > 0) {
                    timerDisplay.textContent = initialTimeLeft;
                } else {
                    clearInterval(timerInterval);
                    startInvisibleTimer();
                }
            }, 1000);
        }

        window.addEventListener('load', () => {
            startInitialTimer();

            app.addEventListener('mousedown', (e) => {
                e.preventDefault(); 
                handleTap();
            });
            
            app.addEventListener('touchstart', (e) => {
                e.preventDefault(); 
                handleTap();
            }, { passive: false });
        });

    </script>
</body>
</html>